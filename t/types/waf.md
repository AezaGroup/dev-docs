# Управление WAF-защитой
> Благодаря нашему API Вы можете автоматизировать Ваши процессы, связанные с DNS и защитой.

При регистрации WAF-Защиты в API нужно передать следующие параметры:
| Поле | Описание | Формат | Пример |
|------------------------------------------------------|--------------------------------| --- | --- |
| domains | список доменов | string[] | ['example.com', 'aeza.net'] |

Пример:
```
// Откройте консоль браузера в ЛК и введите
this.api.query('POST', 'services/orders', {
  count: 1,
  term: 'month',
  name: 'i ochen love api',
  productId: 837, // FREE
  parameters: {
    domains: ['github.com']
  },
  autoProlong: true,
  method: 'balance'
});
```

# Информация о доменах
```GET /services/:ID```

Информация о доменах хранится в payload.domainInfo.
`status` имеет следующие значения:
* active - домен активен, все хорошо
* need_access - билинг обнаружил, что этот домен принадлежит другому клиенту, решается через поддержку.
* need_ns - билинг ожидает, чтобы на домене были NS: ns1.aezadns.com, ns2.aezadns.com

`hasSsl`
* false - SSL отсутствует и в процессе создания
* true - SSL есть.

# Загрузка собственных SSL
> Функция в разработке, можно установить через поддержку.

# Добавление / удаление доменов
`PUT services/:ID` с телом:
```
{
  parameters: {
    domains: [...новый список доменов]
  }
}
```
> Операция заменяет текущий список доменов новым. Отсутствующие домены удалятся с защиты.

# Управление записями
`PUT services/:ID` с телом:
```
{
  parameters: {
    records: {
      'example.com': [...новый список записей]
    }
  }
}
```

> Запросы на обновление параметров можно совмещать.
Передавать другие домены необязательно, но обязательно передать в массив все записи для определенного домена.

Запись имеет следующий формат:
| Поле | Описание | Формат | Пример |
|------------------------------------------------------|--------------------------------| --- | --- |
| type | тип записи | string (см. ```GET /domains/records```) | TXT |
| name | имя записи | string | www ```Для указания домена используйте @, при вводе example.com будет создана запись example.com.example.com.```|
| ttl  | время жизни | integer | 3600 |
| content | контент | string | aeza is fast hosting ```контент должен соответствовать шаблону для типа записи (GET /domains/records)``` |
| protectionMode ```только для типа A, для других типов передавать этот параметр нельзя.``` | режим защиты | passive/aggressive/active ```список доступных режимов доступны в payload.availableModes Вашего тарифа. Если нужен режим без защиты, не передавайте этот параметр.``` | active |

Записи в рамках наших dns можно легко проверить командой (в терминале):
* windows - ```nslookup -type=any ВАШ_ДОМЕН ns1.aezadns.com```
* linux - ```dig @ns1.aezadns.com ВАШ_ДОМЕН any```
